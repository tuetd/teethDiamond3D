(function(i,D,k,O,N,j,F,I,z){"use strict";var T=document.createElement("style");T.textContent=`.popup-content{margin:auto;background:#fff;padding:5px;border:1px solid #d7d7d7;top:0!important;left:0!important;height:100%;width:100%}[role=tooltip].popup-content{box-shadow:0 0 3px #00000029;border-radius:5px}.popup-overlay{background:rgba(0,0,0,.5)}[data-popup=tooltip].popup-overlay{background:transparent}.popup-arrow{-webkit-filter:drop-shadow(0 -3px 3px rgba(0,0,0,.16));filter:drop-shadow(0 -3px 3px rgba(0,0,0,.16));color:#fff;stroke-width:2px;stroke:#d7d7d7;stroke-dasharray:30px;stroke-dashoffset:-54px;left:0;right:0;top:0;bottom:0}
`,document.head.appendChild(T);function H(c){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(c){for(const u in c)if(u!=="default"){const d=Object.getOwnPropertyDescriptor(c,u);Object.defineProperty(a,u,d.get?d:{enumerable:!0,get:()=>c[u]})}}return a.default=c,Object.freeze(a)}const M=H(F);var S={exports:{}},v={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U=i,J=Symbol.for("react.element"),G=Symbol.for("react.fragment"),Y=Object.prototype.hasOwnProperty,W=U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K={key:!0,ref:!0,__self:!0,__source:!0};function C(c,a,u){var d,f={},h=null,g=null;u!==void 0&&(h=""+u),a.key!==void 0&&(h=""+a.key),a.ref!==void 0&&(g=a.ref);for(d in a)Y.call(a,d)&&!K.hasOwnProperty(d)&&(f[d]=a[d]);if(c&&c.defaultProps)for(d in a=c.defaultProps,a)f[d]===void 0&&(f[d]=a[d]);return{$$typeof:J,type:c,key:h,ref:g,props:f,_owner:W.current}}v.Fragment=G,v.jsx=C,v.jsxs=C,S.exports=v;var t=S.exports;const ve="",V=document.getElementById("customize-product-popup").getAttribute("data_model_parameter"),Q=document.getElementById("customize-product-popup").getAttribute("data_json_parameter"),X=document.getElementById("customize-product-popup").getAttribute("data_texture_parameter");document.getElementById("customize-product-popup").getAttribute("product_variants");const L=document.getElementById("customize-product-popup").getAttribute("product_handle"),E={height:"100vh",width:"100%"},Z=()=>{const c=i.useRef(null),a=i.useRef(null),u=i.useRef(null);i.useRef(null),i.useState(null),i.useRef(),i.useState(null);const[d,f]=i.useState(null);i.useState(null);const h=e=>{u.current.show({severity:"general",summary:"Add to cart ",detail:e})},[g,b]=i.useState(!1),[P,w]=i.useState(!1),q=()=>{b(!0)};i.useRef(),new M.WebGLRenderer({preserveDrawingBuffer:!0}),i.useState(null);const $=async e=>{try{console.log("url:"+window.Shopify.routes.root);const o=await fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:e});if(!o.ok)throw new Error("HTTP error! Status: ${res.status}");return{success:!0,data:await o.json()}}catch(o){return{success:!1,error:o.message}}},ee=async e=>{await te(e)},te=async e=>{var o=window.contactInfo;if(!o||o==""){a.current.show({severity:"general",summary:"Add to cart",detail:"Please choose file upload info"});return}if(e.length===0){a.current.show({severity:"general",summary:"Add to cart",detail:"Not found Items for Add to cart"});return}var n=[];e.forEach(async r=>{if(r.variantId){console.log("variantId: "+r.variantId+"#quantity: "+r.quantity);let m={id:r.variantId,quantity:r.quantity};n.push(m)}else console.log("Not found variantOptionsId for Add to cart")}),(await $(JSON.stringify({items:n}))).success&&(oe(),window.location.reload())},oe=()=>{h("Add items successfully!"),B();var e=document.getElementById("popup1-signout");e&&e.click()},ne=()=>{var e=window.glRef;new Promise(o=>{var n=window.glCamera;let[l,s,r]=[0,0,5];n.fov=50,n.near=1,n.far=1e3,n.zoom=.6,n.position.set(l,s,r),e.render(window.scene3D,n),requestAnimationFrame(o)}).then(()=>{const o=e.domElement.toDataURL("image/png");f(o),ue(o)})},re=()=>{b(!1),w(!0)},B=()=>{b(!1),w(!1),A();var e=document.getElementById("variantTeethId");e&&(document.getElementById("variantTeethId").value=""),window.globalFormCartItem=null,window.globalMaterials=null},se=()=>{b(!0),w(!1);var e=document.getElementById("variantTeethId");e&&(document.getElementById("variantTeethId").value=""),window.contactInfo="",le()},ae=()=>{A();var e=window.globalFormCartItem;for(const n in e){var o=e[n];o&&o.description&&o.name&&o.description!==""&&o.name!==""&&me(o)}},ie=async(e,o)=>{var n=null;try{var l="/assets/ProductVariantIdSample.json",s="/assets/Products.json";e!==s&&(l=window.Shopify.routes.root+`products/${o}.js`);const p=await(await fetch(l)).json();console.log(JSON.stringify(p));var r=p.variants?p.variants[0]:null;r!=null&&(n={id:r.id,name:p.title.toUpperCase().replace(/\s+/g,""),price:r.price/100})}catch(m){console.log(m.message)}return n},{globalList:_,addToList:de,removeFromList:be,resetGlobalList:A,isButtonEnabled:ce,disableButton:le,addImageSrcFront:ue,addImageSrcBack:xe}=I.useList(),pe=_.reduce((e,o)=>{var n=0;return o.price===""?n=0:n=o.price,e+n},0),R=_.reduce((e,o)=>{const n=o.group;return e[n]||(e[n]=[]),e[n].push(o),e},{}),fe=[{key:"TL",value:"Top Left "},{key:"TR",value:"Top Right "},{key:"BL",value:"Bottom Left "},{key:"BR",value:"Bottom Right "}],me=async e=>{var o=e.name.replace("mesh_","");if(o){var n=o.split("_",1)[0],l=o.replace(n+"_",""),s="";console.log("Loai Rang"+n+"#Ten Rang:"+l);var r=n.match(/[a-z]+|[0-9]+/gi);if(r){var m=fe.find(y=>y.key===r[0]);m?s=m.value+r[1]:s=n}else s=n;console.log("getProductHanler : "+e.variantname);var p=await ie(L,e.variantname);if(p){var x={group:s,name:l,description:e.description,quantity:1,price:Number(p.price),variantId:p.id};de(x)}}};function he(){const e=document.getElementById("paveOptionTitle");e&&(e.classList.remove("show"),e.classList.add("hide")),document.getElementById("paveOptionLeftTitle").innerHTML="",document.getElementById("paveOptionRightTitle").innerHTML=""}i.useState([]);const ye=()=>{const e=_.reduce((n,l)=>{const s=l.variantId;return n[s]||(n[s]={variantId:s,quantity:0}),n[s].quantity+=l.quantity,n},{}),o=Object.values(e);ee(o)};return t.jsxs("div",{children:[t.jsx(j.Toast,{ref:u,severity:"info",position:"center"}),t.jsx(k,{open:g,id:"popupItem",closeOnDocumentClick:!1,modal:!0,contentStyle:E,trigger:t.jsx("button",{type:"button",onClick:q,className:"shopify-payment-button__button shopify-payment-button__button--unbranded",children:"Customize"}),position:"top  center",children:e=>t.jsxs("div",{className:"modal",children:[t.jsx(j.Toast,{ref:c,severity:"error",position:"center"}),t.jsx(O.Button,{type:"button",style:{border:"3px solid rgb(59, 58, 58)"},id:"popup1-confirm",rounded:!0,icon:"pi",className:"confirm p-button-component",onClick:async o=>{he(),ne(),re(),ae()},children:"Checkout"}),t.jsx(O.Button,{type:"button",style:{border:"3px solid rgb(59, 58, 58)"},id:"popup1-signout",rounded:!0,icon:"pi",className:"close p-button-component",onClick:o=>{B(),e()},children:"Back"}),t.jsx(i.Suspense,{fallback:t.jsx("center",{children:t.jsx("div",{children:"Loading, please wait... "})}),children:t.jsx(N,{product_handle:L,data_model_parameter:V,data_json_parameter:Q,data_texture_parameter:X})})]})}),t.jsxs(k,{closeOnDocumentClick:!1,open:P,modal:!0,contentStyle:E,id:"popupConfirm",position:"top  center",children:[t.jsx(j.Toast,{ref:a,severity:"error",position:"center"}),t.jsx("button",{type:"button",className:"shopify-payment-button__button shopify-payment-button__button--unbranded",onClick:e=>{se()},children:"Return"}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"orderDetail",children:[t.jsxs("div",{className:"columnOrderDetail",style:{backgroundColor:"#f0eded",overflowY:"auto",maxHeight:"700px"},children:[P&&t.jsx("img",{src:d,alt:"Captured Canvas",width:750,height:300,style:{marginTop:"0px",border:""}}),t.jsx("br",{}),t.jsx(z,{})]}),t.jsxs("div",{className:"columnOrderDetailRigth",style:{backgroundColor:"#f0eded"},children:[t.jsx("h2",{children:t.jsx("b",{children:"ORDER DETAILS"})}),t.jsx("div",{style:{overflowY:"auto",maxHeight:"600px"},children:Object.keys(R).map(e=>{const o=R[e],n=new Set,l=o.reduce((s,r)=>{const m=`${r.name}-${r.description}`;if(!n.has(m)){n.add(m);const p=o.filter(y=>y.name===r.name&&y.description===r.description),x=p.reduce((y,ge)=>y+ge.price,0);s.push({name:r.name,description:r.description,items:p,total:x})}return s},[]);return t.jsxs("div",{children:[t.jsx("h3",{children:t.jsx("b",{children:e})}),l.map((s,r)=>t.jsx("div",{children:t.jsxs("tr",{children:[t.jsxs("td",{width:500,children:[s.name,"-",s.description," "]}),t.jsxs("td",{style:{textAlign:"right"},children:[" ",s.total," USD"]})]})},r))]},e)})}),t.jsx("h3",{children:t.jsxs("tr",{children:[t.jsx("td",{width:500,children:t.jsx("b",{children:"TOTAL"})}),t.jsx("td",{style:{textAlign:"right"},children:t.jsxs("b",{children:[pe," USD"]})})]})}),t.jsx("div",{style:{textAlign:"left"},children:t.jsx("button",{type:"button",disabled:ce,className:"shopify-payment-button__button shopify-payment-button__button--unbranded",onClick:e=>{ye()},children:"ADD TO CART"})})]})]})]})]})};D.createRoot(document.getElementById("customize-product-popup")).render(t.jsx(I.ListProvider,{children:t.jsx(Z,{})}))})(React,ReactDOM,Popup,primereact,App,primereact,THREE,ListContext,ContactInfo);
